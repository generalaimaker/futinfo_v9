# FutInfo 앱: iOS to Android 마이그레이션 및 현재 상태

## 1. 프로젝트 개요

**FutInfo**는 iOS 플랫폼에서 시작된 축구 정보 제공 애플리케이션입니다. 사용자에게 전 세계 축구 리그의 경기 일정, 결과, 순위, 선수 정보 등 다양한 데이터를 제공하는 것을 목표로 합니다. 현재 이 프로젝트는 기존 iOS 앱의 핵심 기능들을 Android 플랫폼으로 마이그레이션하고, 두 플랫폼 간의 일관된 사용자 경험을 제공하기 위한 작업을 진행 중입니다.

## 2. Android 아키텍처 및 기술 스택 상세

### 2.1. Clean Architecture
Clean Architecture는 소프트웨어의 관심사를 계층별로 분리하여 코드의 유지보수성, 테스트 용이성, 확장성을 크게 향상시키는 아키텍처 패턴입니다.

- **Presentation Layer (프레젠테이션 계층)**: UI 관련 로직을 담당하며, Jetpack Compose, ViewModel, State로 구성됩니다. 사용자 인터페이스와 사용자 상호작용을 처리합니다.
- **Domain Layer (도메인 계층)**: 비즈니스 로직의 핵심을 담당하며, UseCases와 Repository Interfaces로 구성됩니다. 플랫폼에 독립적인 순수한 비즈니스 규칙을 포함합니다.
- **Data Layer (데이터 계층)**: 데이터 소스 관리를 담당하며, Repository 구현체, Room(로컬), Retrofit(원격)으로 구성됩니다.

**의존성 규칙**: 각 계층은 안쪽 계층(Domain)으로만 의존성을 가지며, 바깥쪽 계층에 대한 의존성은 금지됩니다. 이를 통해 비즈니스 로직이 UI나 데이터베이스 변경에 영향받지 않도록 보장합니다.

### 2.2. MVVM (Model-View-ViewModel)
Presentation Layer 내에서 UI(View)와 비즈니스 로직(ViewModel)을 명확히 분리하는 패턴입니다.

- **View**: Jetpack Compose로 구현된 UI 컴포넌트로, 사용자에게 데이터를 표시하고 사용자 입력을 받습니다.
- **ViewModel**: UI 상태를 관리하고 비즈니스 로직을 처리합니다. StateFlow를 사용하여 UI 상태를 반응형으로 관리하며, 화면 회전 등의 구성 변경에도 데이터가 유지됩니다.
- **Model**: Domain Layer의 UseCases를 통해 데이터를 제공받아 ViewModel에서 UI에 적합한 형태로 변환합니다.

StateFlow를 통한 단방향 데이터 흐름으로 예측 가능하고 안정적인 UI 상태 관리를 실현합니다.

### 2.3. Jetpack Compose
선언형 UI 프레임워크로, 기존 XML 기반 View 시스템 대비 다음과 같은 이점을 제공합니다.

- **선언형 패러다임**: UI의 상태에 따라 어떻게 보여야 하는지를 선언하면, Compose가 자동으로 UI를 업데이트합니다.
- **코드 간결성**: XML과 Java/Kotlin 코드를 분리할 필요 없이 하나의 언어로 UI를 구성할 수 있어 개발 생산성이 크게 향상됩니다.
- **실시간 미리보기**: Android Studio에서 코드 변경 사항을 즉시 미리볼 수 있어 개발 속도가 빨라집니다.
- **재사용성**: 컴포저블 함수를 통해 UI 컴포넌트의 재사용성이 높아집니다.

### 2.4. Hilt (의존성 주입)
의존성 주입(Dependency Injection)은 객체가 필요로 하는 의존성을 외부에서 제공하는 디자인 패턴입니다.

- **보일러플레이트 코드 감소**: Hilt는 Dagger를 기반으로 하여 복잡한 DI 설정을 자동화하고, 어노테이션 기반으로 간단하게 의존성을 주입할 수 있습니다.
- **생명주기 관리**: Android 컴포넌트의 생명주기에 맞춰 자동으로 의존성을 생성하고 소멸시킵니다.
- **테스트 용이성**: 의존성이 외부에서 주입되므로 테스트 시 Mock 객체로 쉽게 대체할 수 있습니다.
- **싱글톤 관리**: `@Singleton`, `@ActivityScoped` 등의 스코프를 통해 객체의 생명주기를 효율적으로 관리합니다.

### 2.5. Room & Retrofit (데이터 계층)
Data Layer에서 로컬 캐싱과 원격 API 통신을 분리하여 처리하는 구조입니다.

- **Room (로컬 캐싱)**: SQLite 위에 구축된 추상화 레이어로, 컴파일 타임에 SQL 쿼리를 검증하고 타입 안전성을 보장합니다. 오프라인 상황에서도 앱이 동작할 수 있도록 데이터를 로컬에 캐싱합니다.
- **Retrofit (원격 API 통신)**: RESTful API와의 통신을 위한 타입 안전한 HTTP 클라이언트입니다. 어노테이션 기반으로 API 엔드포인트를 정의하고, JSON 직렬화/역직렬화를 자동으로 처리합니다.
- **Repository 패턴**: Room과 Retrofit을 추상화하여 Domain 및 Presentation Layer에 일관된 데이터 소스를 제공합니다. 네트워크 상태에 따라 로컬 캐시 또는 원격 API에서 데이터를 가져오는 로직을 캡슐화합니다.

### 2.6. 기타 핵심 기술
-   **언어:** Kotlin 100%
-   **UI:** Jetpack Compose (Material 3 및 커스텀 iOS 스타일 디자인 시스템 적용)
-   **비동기 처리:** Kotlin Coroutines & Flow
-   **네트워크:** Retrofit2 & OkHttp3 (API 통신)
-   **데이터베이스:** Room (로컬 데이터 캐싱)
-   **데이터 저장소:** Jetpack DataStore (사용자 설정 저장)
-   **이미지 로딩:** Coil

## 3. 현재까지 진행된 주요 작업

### 3.1. iOS -> Android 기능 마이그레이션
-   **데이터베이스 스키마:** Room을 사용하여 iOS의 CoreData에 해당하는 리그, 경기, 순위, 팀 프로필 등의 엔티티를 구현했습니다.
-   **API 연동:** Retrofit을 사용하여 `api-football-v1` API와의 연동을 구현했습니다. 특히, 여러 리그의 경기 정보를 병렬로 효율적으로 가져오기 위해 Coroutines의 `async`/`awaitAll`을 사용했습니다.
-   **사용자 설정:** SharedPreferences (이후 DataStore로 개선 예정)를 사용하여 사용자가 선호하는 리그를 선택하고 저장하는 기능을 구현했습니다.
-   **UI 구현:** Jetpack Compose를 사용하여 주요 화면(리그 목록, 경기 목록, 경기 상세)의 기본 구조를 구현하고, iOS의 디자인 가이드라인을 참고한 커스텀 디자인 시스템(`FutInfoDesignSystem`)을 적용했습니다.

### 3.2. 주요 문제 해결 과정

#### 문제 1: API `season` 파라미터 강제화로 인한 데이터 로딩 실패
-   **현상:** 앱의 모든 경기 관련 데이터(경기 목록, 로고 등)가 로드되지 않는 치명적인 버그 발생.
-   **원인 분석:** `Logcat`을 통해 API 응답을 분석한 결과, `/fixtures` 엔드포인트 호출 시 `season` 파라미터가 필수로 변경되었음을 확인했습니다.
-   **1차 해결:** `FootballRepositoryImpl.kt`의 `getFixtures` 메소드에 현재 연도를 기본 `season` 값으로 추가하여 문제를 해결했습니다.
-   **2차 문제 발생:** 1차 해결 이후, 특정 경기 ID로 상세 정보를 조회할 때 새로운 오류가 발생했습니다. API는 `id`로 조회 시 다른 파라미터(특히 `season`)를 함께 보내는 것을 허용하지 않았습니다.
-   **최종 해결:** `getFixtures` 메소드에 조건부 로직을 추가하여, `id`가 인자로 존재할 경우 `id`만으로 API를 호출하고, 그렇지 않을 경우에만 `season`을 포함한 다른 파라미터로 호출하도록 수정하여 문제를 완전히 해결했습니다.

#### 문제 2: 경기 상세 화면 탭 UI 오류
-   **현상:** 경기 상세 화면에서 탭(요약, 통계, 라인업 등)의 텍스트가 배경색과 동일하여 보이지 않는 문제 발생.
-   **원인 분석:** `ScrollableTabRow` 컴포저블의 `contentColor`가 명시적으로 설정되지 않아, 상위 테마의 색상을 그대로 상속받아 발생한 문제였습니다.
-   **해결:** `FixtureDetailScreen.kt`의 `DynamicTabRow` 컴포저블에서 `Tab`의 `selectedContentColor`와 `unselectedContentColor`를 `FutInfoDesignSystem`에 정의된 색상으로 명시적으로 지정하여 탭의 가시성을 확보하고 UI를 개선했습니다.

## 4. 현재 상태 및 다음 단계

-   **현재 상태:**
    -   핵심적인 API 호출 오류와 UI 버그가 모두 해결되었습니다.
    -   앱은 안정적으로 빌드 및 실행되며, 주요 기능(리그/경기 목록 조회, 경기 상세 정보 조회)이 정상적으로 작동합니다.
-   **다음 단계:**
    -   전체적인 UI/UX를 iOS 버전과 유사하게 다듬는 작업이 필요합니다.
    -   아직 구현되지 않은 부가 기능(선수 상세, 팀 상세 등)을 추가 개발합니다.
    -   안정성 향상을 위한 단위 테스트 및 UI 테스트 코드를 작성합니다.

이 문서는 프로젝트의 현재 상태를 정확히 반영하며, 새로운 팀원이 합류하거나 작업을 이어서 진행할 때 유용한 가이드가 될 것입니다.